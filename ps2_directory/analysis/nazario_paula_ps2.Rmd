---
title: "Educ 260B - Problem Set 2"
author: "Paula Nazario"
date: "January 20, 2022"
output:
  pdf_document: default
  html_document: default
bibliography: ../bib/references.bib
csl: ../bib/apa.csl
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F, out.width = '75%', fig.align = 'center')

# Load libraries
## install.packages("tidyverse")
library(tidyverse)
## install.packages("scales")
library(scales)
## install.packages("knitr")
library(knitr)
## install.packages("kableExtra")
library(kableExtra)

# Directory paths
data_dir <- file.path('.', 'files')
list.files(data_dir)

```

# About the data
According to @housing, the California Housing Prices data accounts for the median house prices for California from the 1990 census. In this data set, the column names are as follows: longitude; latitude; housingmedianage; total_rooms; total_bedrooms; population; households; median_income; medianhousevalue; and ocean_proximity. According to the California Housing Prices data, the average housing media age is 28.6. In terms of median income, the average was 3.87K, with a standard deviation of 1.9K. Furthermore, in terms of median house value, the average value seems to be 207K, with a standard deviation of 115K [@housing]. 

```{r}
## Part III, Question 6
list.files(data_dir)
housing_df <- readRDS(file = file.path(data_dir, 'housing.RDS'))
housing_df %>%
      head(10) %>% 
      kable() %>%
      kable_styling(latex_options = c('scale_down', 'HOLD_position'))

```


# Data analysis

```{r}
## Part IV, Question 1

## Investigations
## housing_df$ocean_proximity
## housing_df$ocean_proximity %>% str()
## housing_df$ocean_proximity %>% typeof()
## housing_df$ocean_proximity %>% class()
## housing_df %>% select(ocean_proximity) %>% count()
## housing_df$ocean_proximity %>% summary()

## Plots from Part II, Question 5
ggplot(data = housing_df, mapping = aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point()
ggplot(data = housing_df, aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point()

## Title and Labels 
ggplot(data = housing_df, mapping = aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') 

ggplot(data = housing_df, aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') 

## Palettes 
ggplot(data = housing_df, mapping = aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') + scale_color_brewer(palette = 'Spectral')

ggplot(data = housing_df, aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') + scale_color_brewer(palette = 'Spectral')

## Legend Title
ggplot(data = housing_df, mapping = aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') + scale_color_brewer(palette = 'Spectral', name = 'Proximity to the Ocean') + scale_x_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 15, accuracy = 1)) + scale_y_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 1e-3, accuracy = 1)) + theme_minimal()

ggplot(data = housing_df, aes(x = median_income, y = median_house_value, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') + scale_color_brewer(palette = 'Spectral', name = 'Proximity to the Ocean') + scale_x_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 15, accuracy = 1)) + scale_y_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 1e-3, accuracy = 1))  + theme_minimal()

## Based on this plot, we can assume that there is a strong upward correlation between the median income and median house value. It also looks like people whose median income ranges between $0k to $75K live near the inland area, which is further away from the ocean and those homes have a lower median house value.
```


```{r}
## Part IV, Question 2

## facet_wrap()
ggplot(data = housing_df, mapping = aes(x = median_income, y = median_house_value)) + geom_point() + facet_wrap(~ ocean_proximity, nrow = 2) + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') + scale_color_brewer(palette = 'Spectral', name = 'Proximity to the Ocean') + scale_x_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 15, accuracy = 1)) + scale_y_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 1e-3, accuracy = 1)) + theme_minimal()

## facet_grid()
ggplot(data = housing_df, aes(x = median_income, y = median_house_value)) + geom_point() + facet_grid(~ocean_proximity) + ggtitle('Correlation Between the Median Income and Median House Value') + xlab('Median Income') + ylab('Median House Value') + scale_color_brewer(palette = 'Spectral', name = 'Proximity to the Ocean') + scale_x_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 15, accuracy = 1)) + scale_y_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 1e-3, accuracy = 1))  + theme_minimal()

## According to these facet_wrap and facet_grid plots, it looks like there are strong correlations between the median income and median house value of residents who live near the bay, ocean, <1H ocean, and in the inland area. There doesn't seem to be a strong correlation among those residents who live in the island. 

```

```{r}
## Part IV, Question 3

## coord_fixed()
ggplot(data = housing_df, mapping = aes(x = longitude, y = latitude, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between Longitude and Latitude of Housing') + xlab('Longitude') + ylab('Latitude') + scale_color_brewer(palette = 'Accent', name = 'Proximity to the Ocean') + theme_minimal() + coord_fixed()

ggplot(data = housing_df, aes(x = longitude, y = latitude, color = ocean_proximity)) + geom_point() + ggtitle('Correlation Between Longitude and Latitude of Housing') + xlab('Longitude') + ylab('Latitude') + scale_color_brewer(palette = 'Set2', name = 'Proximity to the Ocean') + theme_minimal() + coord_fixed()

## In this plot, there is a clear distinction between location of housing units in the state of California and the number of people who live close to the islands, near the bay, near the ocean, <1H ocean, and in the inland areas. I think that this plot does a great job at painting a picture of the number of people who live closer to the oceans vs those who don't.
```

```{r}
## Part IV, Question 4

## Gradients
ggplot(data = housing_df, mapping = aes(x = longitude, y = latitude, color = median_house_value)) + geom_point() + ggtitle('Correlation Between Housing Area and Median Housing Value') + xlab('Longitude') + ylab('Latitude') + scale_color_gradient(low = 'green', high = 'black', name = 'Median House Value Percentage', labels = label_number(suffix = '%')) + theme_bw() + coord_fixed()

ggplot(data = housing_df, aes(x = longitude, y = latitude, color = median_house_value)) + geom_point() + ggtitle('Correlation Between Housing Area and Median Housing Value') + xlab('Longitude') + ylab('Latitude') + scale_color_gradient(low = 'green', high = 'black', name = 'Median House Value Percentage', labels = label_number(suffix = '%')) + theme_bw() + coord_fixed()

## This plot shows the correlation between the housing areas and median housing values in the state of California and I think that this graph also does a great job at depicting the levels of median household values in the state. From this plot, it seems that the value of homes near the coast are more expensive relative to the homes near the inland areas. 
```

```{r}
## Part IV, Question 5

## Bar plot
housing_df %>% group_by(ocean_proximity) %>% summarise(mean = mean(median_house_value)) %>%
  ggplot(mapping = aes(x = ocean_proximity, y = mean)) +  geom_col(width = .95) + ggtitle('Average Median Housing Value by Ocean Proximity') + xlab('Proximity to the Ocean') + ylab('Average Median Housing Value') + scale_y_continuous(labels = label_number(prefix = '$', suffix = 'K', scale = 1e-3, accuracy = 1)) + theme_grey()

## According to this bar plot, it seems that the closer the homes are to the inland area, the more affordable they are in average median housing value. 

```

```{r}
## Part V: Bonus question
## Create a plot of your choosing showing any variables you'd like from the housing dataset. However, this cannot be a scatterplot or barplot, as you've done in the previous questions. Make sure to title and label the plot appropriately and customize it how you'd like. Then, write some text describing your findings or observations.

ggplot(data = housing_df, aes(x = median_income, y = total_rooms / households )) + geom_smooth() + ggtitle('Correlation Between Median Housing Income and Total Rooms') + xlab('Median Income') + ylab('Total Room') +  theme_classic()
## According to the smoothed prediction lines, it seems like there is a strong correlation between a high median housing income and total rooms.

```

```{r}
## Part VI: Create a GitHub issue   
## Paste the url to your issue here: https://github.com/anyone-can-cook/rclass2_w22_student_issues/issues/53
## Paste the url to the issue you responded to here: https://github.com/anyone-can-cook/rclass2_w22_student_issues/issues/52
```


# References

